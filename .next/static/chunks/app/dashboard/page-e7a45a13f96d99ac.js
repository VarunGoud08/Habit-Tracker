(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{81291:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(62898);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},17158:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(62898);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},40279:function(e,t,a){Promise.resolve().then(a.bind(a,66920))},66920:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Dashboard}});var s=a(57437),r=a(2265),n=a(53086),i=a(36076),d=a(43568);function addDays(e,t){let a=(0,i.Q)(e);return isNaN(t)?(0,d.L)(e,NaN):(t&&a.setDate(a.getDate()+t),a)}var l=a(82522),date_fns_isSameDay=function(e,t){let a=(0,l.b)(e),s=(0,l.b)(t);return+a==+s},o=a(81291),c=a(17158),g=a(81016),x=a(62442),h=a(82549),u=a(64891),b=a(79303),f=a(60345),m=a(75121);function Dashboard(){let[e,t]=(0,r.useState)(new Date),[a,i]=(0,r.useState)([]),[d,l]=(0,r.useState)([]),[y,p]=(0,r.useState)(null),[j,v]=(0,r.useState)([]),[k,N]=(0,r.useState)(!0),fetchData=async()=>{N(!0);let t=(0,n.ZP)(e,"yyyy-MM-dd"),[a,s,r,d]=await Promise.all([fetch("/api/habits"),fetch("/api/streaks"),fetch("/api/days?date=".concat(t)),fetch("/api/streaks/log?date=".concat(t))]),o=await a.json();i(o.filter(e=>e.isActive));let c=await s.json();l(c.filter(e=>e.isActive)),p(await r.json()),v(await d.json()),N(!1)};(0,r.useEffect)(()=>{fetchData()},[e]);let handleStatusChange=async(t,s)=>{let r=(null==y?void 0:y.entries)||[],i=r.findIndex(e=>e.habitId===t),d=[...r];i>=0?d[i]={...d[i],status:s}:d.push({habitId:t,status:s});let l=0;for(let e of d){let t=a.find(t=>t.id===e.habitId);t&&("COMPLETED"===e.status?l+=t.points:"MISSED"===e.status&&(l+=t.missedPoints))}p(t=>({...t,id:(null==t?void 0:t.id)||"temp",date:(0,n.ZP)(e,"yyyy-MM-dd"),totalScore:l,entries:d})),await fetch("/api/days",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:(0,n.ZP)(e,"yyyy-MM-dd"),entries:d})})},handleStreakUpdate=async(t,a)=>{let s=[...j],r=s.findIndex(e=>e.streakId===t);r>=0?s[r]={...s[r],status:a}:s.push({streakId:t,status:a}),v(s);let i=await fetch("/api/streaks/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({streakId:t,date:(0,n.ZP)(e,"yyyy-MM-dd"),status:a})}),d=await i.json();d.streak&&l(e=>e.map(e=>e.id===d.streak.id?d.streak:e))},getHabitStatus=e=>{var t;return(null==y?void 0:null===(t=y.entries.find(t=>t.habitId===e))||void 0===t?void 0:t.status)||"UNTRACKED"},getStreakStatus=e=>{var t;return(null===(t=j.find(t=>t.streakId===e))||void 0===t?void 0:t.status)||"UNTRACKED"};return(0,s.jsxs)("div",{className:"space-y-8 pb-20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between glass-panel p-4",children:[(0,s.jsx)("button",{onClick:()=>t(addDays(e,-1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(o.Z,{})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:date_fns_isSameDay(e,new Date)?"Today":(0,n.ZP)(e,"EEEE")}),(0,s.jsx)("p",{className:"text-gray-500",children:(0,n.ZP)(e,"MMMM d, yyyy")})]}),(0,s.jsx)("button",{onClick:()=>t(addDays(e,1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition-colors",children:(0,s.jsx)(c.Z,{})})]}),(0,s.jsxs)(b.E.div,{initial:{scale:.9},animate:{scale:1},className:(0,f.cn)("text-center p-8 rounded-3xl transition-colors duration-500",((null==y?void 0:y.totalScore)||0)>0?"bg-green-500/10 text-green-600 dark:bg-green-500/20 dark:text-green-400":0>((null==y?void 0:y.totalScore)||0)?"bg-red-500/10 text-red-600 dark:bg-red-500/20 dark:text-red-400":"bg-gray-100 text-gray-500 dark:bg-white/5 dark:text-gray-400"),children:[(0,s.jsxs)("span",{className:"text-6xl font-black tracking-tighter",children:[((null==y?void 0:y.totalScore)||0)>0?"+":"",(null==y?void 0:y.totalScore)||0]}),(0,s.jsx)("p",{className:"text-sm font-medium opacity-80 mt-2 uppercase tracking-wide",children:"Daily Score"})]},null==y?void 0:y.totalScore),d.length>0&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold flex items-center gap-2 text-orange-500",children:[(0,s.jsx)(g.Z,{size:20,className:"fill-orange-500"}),"Active Streaks"]}),(0,s.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:d.map(e=>(0,s.jsx)(m.Z,{streak:e,status:getStreakStatus(e.id),onUpdateStatus:handleStreakUpdate,compact:!0},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-500",children:"Habits"}),k?(0,s.jsx)("p",{className:"text-center text-gray-500 py-12",children:"Loading habits..."}):a.map((e,t)=>{let a=getHabitStatus(e.id);return(0,s.jsxs)(b.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:(0,f.cn)("glass-panel p-4 flex flex-col md:flex-row items-center justify-between gap-4 transition-all duration-300","COMPLETED"===a?"border-green-500/30 bg-green-50/50 dark:bg-green-900/10":"MISSED"===a?"border-red-500/30 bg-red-50/50 dark:bg-red-900/10":"SKIPPED"===a?"opacity-60":""),children:[(0,s.jsxs)("div",{className:"flex-1 text-center md:text-left",children:[(0,s.jsx)("h3",{className:"text-lg font-bold",children:e.name}),(0,s.jsxs)("div",{className:"text-xs font-medium text-gray-400 flex gap-2 justify-center md:justify-start mt-1",children:[(0,s.jsxs)("span",{children:["Done: ",e.points>0?"+":"",e.points]}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsxs)("span",{children:["Miss: ",e.missedPoints>0?"+":"",e.missedPoints]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>handleStatusChange(e.id,"COMPLETED"),className:(0,f.cn)("p-4 rounded-xl transition-all","COMPLETED"===a?"bg-green-500 text-white shadow-lg shadow-green-500/30 scale-105":"bg-gray-100 dark:bg-white/5 text-gray-400 hover:bg-green-100 dark:hover:bg-green-900/20 hover:text-green-600"),children:(0,s.jsx)(x.Z,{size:24})}),(0,s.jsx)("button",{onClick:()=>handleStatusChange(e.id,"MISSED"),className:(0,f.cn)("p-4 rounded-xl transition-all","MISSED"===a?"bg-red-500 text-white shadow-lg shadow-red-500/30 scale-105":"bg-gray-100 dark:bg-white/5 text-gray-400 hover:bg-red-100 dark:hover:bg-red-900/20 hover:text-red-600"),children:(0,s.jsx)(h.Z,{size:24})}),(0,s.jsx)("button",{onClick:()=>handleStatusChange(e.id,"SKIPPED"),className:(0,f.cn)("p-4 rounded-xl transition-all","SKIPPED"===a?"bg-gray-500 text-white shadow-lg shadow-gray-500/30 scale-105":"bg-gray-100 dark:bg-white/5 text-gray-400 hover:bg-gray-200 dark:hover:bg-white/10 hover:text-gray-600"),children:(0,s.jsx)(u.Z,{size:24})})]})]},e.id)})]})]})}},75121:function(e,t,a){"use strict";a.d(t,{Z:function(){return StreakCard}});var s=a(57437),r=a(79303),n=a(81016),i=a(62442),d=a(8957),l=a(82549),o=a(64891),c=a(60345),g=a(68034);function StreakCard(e){let{streak:t,status:a,onUpdateStatus:x,compact:h=!1}=e;return(0,s.jsxs)(r.E.div,{layout:!0,className:(0,c.cn)("glass-panel relative overflow-hidden transition-all duration-300",h?"p-4":"p-6","BROKEN"===a?"border-red-500/20 bg-red-500/5":"FOLLOWED"===a?"border-green-500/20 bg-green-500/5":""),children:[t.currentStreak>0&&"BROKEN"!==a&&(0,s.jsx)("div",{className:"absolute -right-4 -bottom-4 opacity-5 pointer-events-none",children:(0,s.jsx)(n.Z,{size:h?100:180})}),(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:(0,c.cn)("text-[10px] font-bold px-2 py-0.5 rounded-full border","AVOID"===t.type?"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800":"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800"),children:t.type}),"FOLLOWED"===a&&(0,s.jsx)(i.Z,{size:14,className:"text-green-500"})]}),(0,s.jsx)("h3",{className:(0,c.cn)("font-bold",h?"text-lg":"text-xl"),children:t.name}),!h&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:t.description})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"flex items-center justify-end gap-1 text-2xl font-black",children:[(0,s.jsx)(n.Z,{size:24,className:(0,c.cn)(t.currentStreak>0&&"BROKEN"!==a?"fill-orange-500 text-orange-500 animate-pulse":"text-gray-300")}),(0,s.jsx)("span",{children:t.currentStreak})]}),(0,s.jsx)("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider",children:"Current Streak"})]})]}),!h&&(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-6 text-xs text-gray-400 bg-gray-50 dark:bg-white/5 p-2 rounded-lg w-fit",children:[(0,s.jsx)(d.Z,{size:14,className:"text-yellow-500"}),(0,s.jsxs)("span",{children:["Best: ",Math.max(t.highestStreak,t.currentStreak)," days"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{"FOLLOWED"!==a&&(0,g.Z)({particleCount:50,spread:60,origin:{y:.7},colors:["#22c55e","#ffffff"]}),x(t.id,"FOLLOWED")},className:(0,c.cn)("flex-1 flex items-center justify-center gap-2 py-2 rounded-xl text-sm font-medium transition-all active:scale-95","FOLLOWED"===a?"bg-green-500 text-white shadow-lg shadow-green-500/20":"bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 hover:border-green-500 hover:text-green-500"),children:[(0,s.jsx)(i.Z,{size:18}),h?"":"Followed"]}),(0,s.jsxs)("button",{onClick:()=>x(t.id,"BROKEN"),className:(0,c.cn)("flex-1 flex items-center justify-center gap-2 py-2 rounded-xl text-sm font-medium transition-all active:scale-95","BROKEN"===a?"bg-red-500 text-white shadow-lg shadow-red-500/20":"bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 hover:border-red-500 hover:text-red-500"),children:[(0,s.jsx)(l.Z,{size:18}),h?"":"Broken"]}),(0,s.jsx)("button",{onClick:()=>x(t.id,"SKIP"),className:(0,c.cn)("flex-none w-10 flex items-center justify-center rounded-xl transition-all active:scale-95","SKIP"===a?"bg-gray-500 text-white":"bg-gray-100 dark:bg-zinc-900 text-gray-400 hover:bg-gray-200"),title:"Skip (Day Off)",children:(0,s.jsx)(o.Z,{size:18})})]})]})}},60345:function(e,t,a){"use strict";a.d(t,{cn:function(){return cn}});var s=a(57042),r=a(74769);function cn(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},function(e){e.O(0,[777,928,769,855,971,472,744],function(){return e(e.s=40279)}),_N_E=e.O()}]);