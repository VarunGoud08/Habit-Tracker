(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[709],{9883:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(62898);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},58457:function(e,t,a){Promise.resolve().then(a.bind(a,22252))},22252:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return StreaksPage}});var r=a(57437),s=a(2265),n=a(75121),i=a(79303),l=a(81016),d=a(82549);function StreakForm(e){let{onClose:t,onSave:a,initialData:n}=e,[c,o]=(0,s.useState)({name:(null==n?void 0:n.name)||"",description:(null==n?void 0:n.description)||"",type:(null==n?void 0:n.type)||"AVOID"}),[x,u]=(0,s.useState)(!1),handleSubmit=async e=>{e.preventDefault(),u(!0);let t=n?"/api/streaks/".concat(n.id):"/api/streaks";await fetch(t,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),u(!1),a()};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm",children:(0,r.jsxs)(i.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-black w-full max-w-md rounded-3xl p-6 shadow-2xl border border-gray-100 dark:border-zinc-800",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg text-orange-500",children:(0,r.jsx)(l.Z,{size:20})}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:n?"Edit Streak":"New Streak"})]}),(0,r.jsx)("button",{onClick:t,children:(0,r.jsx)(d.Z,{size:20})})]}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Name"}),(0,r.jsx)("input",{required:!0,className:"input-field",value:c.name,onChange:e=>o({...c,name:e.target.value}),placeholder:"e.g. No Sugar"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Type"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>o({...c,type:"AVOID"}),className:"p-3 rounded-xl border-2 text-sm font-bold transition-all ".concat("AVOID"===c.type?"border-orange-500 bg-orange-50 text-orange-600 dark:bg-orange-900/10":"border-transparent bg-gray-50 text-gray-400"),children:["AVOID",(0,r.jsx)("span",{className:"block text-[10px] font-normal opacity-70",children:"Bad habits (e.g. Junk Food)"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>o({...c,type:"MAINTAIN"}),className:"p-3 rounded-xl border-2 text-sm font-bold transition-all ".concat("MAINTAIN"===c.type?"border-blue-500 bg-blue-50 text-blue-600 dark:bg-blue-900/10":"border-transparent bg-gray-50 text-gray-400"),children:["MAINTAIN",(0,r.jsx)("span",{className:"block text-[10px] font-normal opacity-70",children:"Good habits (e.g. Reading)"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Description"}),(0,r.jsx)("textarea",{className:"input-field min-h-[80px] py-3",value:c.description,onChange:e=>o({...c,description:e.target.value}),placeholder:"Rules for this streak..."})]}),(0,r.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 bg-gray-100 dark:bg-zinc-900 rounded-xl font-medium",children:"Cancel"}),(0,r.jsx)("button",{disabled:x,type:"submit",className:"flex-1 py-3 bg-black text-white dark:bg-white dark:text-black rounded-xl font-medium",children:x?"Saving...":"Start Streak"})]})]})]})})}var c=a(9883),o=a(53086);function StreaksPage(){let[e,t]=(0,s.useState)([]),[a,d]=(0,s.useState)([]),[x,u]=(0,s.useState)(!1),[b,g]=(0,s.useState)(null),fetchData=async()=>{let e=await fetch("/api/streaks"),a=await e.json();t(a);let r=(0,o.ZP)(new Date,"yyyy-MM-dd"),s=await fetch("/api/streaks/log?date=".concat(r)),n=await s.json();d(n)};(0,s.useEffect)(()=>{fetchData()},[]);let handleUpdateStatus=async(e,r)=>{let s=[...a],n=s.findIndex(t=>t.streakId===e);n>=0?s[n]={...s[n],status:r}:s.push({streakId:e,status:r}),d(s);let i=await fetch("/api/streaks/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({streakId:e,date:(0,o.ZP)(new Date,"yyyy-MM-dd"),status:r})}),l=await i.json();l.streak&&t(e=>e.map(e=>e.id===l.streak.id?l.streak:e))},getStatus=e=>{var t;return(null===(t=a.find(t=>t.streakId===e))||void 0===t?void 0:t.status)||"UNTRACKED"};return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,r.jsx)(l.Z,{className:"text-orange-500 fill-orange-500"}),"Streaks"]}),(0,r.jsx)("p",{className:"text-gray-500",children:"Protect your chains. Never break a streak."})]}),(0,r.jsxs)("button",{onClick:()=>{g(null),u(!0)},className:"btn-primary flex items-center gap-2",children:[(0,r.jsx)(c.Z,{size:20}),"New Streak"]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map((e,t)=>(0,r.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},children:(0,r.jsx)(n.Z,{streak:e,status:getStatus(e.id),onUpdateStatus:handleUpdateStatus})},e.id)),0===e.length&&(0,r.jsx)("div",{className:"col-span-full py-12 text-center text-gray-500 border-2 border-dashed border-gray-200 dark:border-zinc-800 rounded-3xl",children:(0,r.jsx)("p",{children:"No streaks active."})})]}),x&&(0,r.jsx)(StreakForm,{onClose:()=>u(!1),onSave:()=>{u(!1),fetchData()},initialData:b})]})}},75121:function(e,t,a){"use strict";a.d(t,{Z:function(){return StreakCard}});var r=a(57437),s=a(79303),n=a(81016),i=a(62442),l=a(8957),d=a(82549),c=a(64891),o=a(60345),x=a(68034);function StreakCard(e){let{streak:t,status:a,onUpdateStatus:u,compact:b=!1}=e;return(0,r.jsxs)(s.E.div,{layout:!0,className:(0,o.cn)("glass-panel relative overflow-hidden transition-all duration-300",b?"p-4":"p-6","BROKEN"===a?"border-red-500/20 bg-red-500/5":"FOLLOWED"===a?"border-green-500/20 bg-green-500/5":""),children:[t.currentStreak>0&&"BROKEN"!==a&&(0,r.jsx)("div",{className:"absolute -right-4 -bottom-4 opacity-5 pointer-events-none",children:(0,r.jsx)(n.Z,{size:b?100:180})}),(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("span",{className:(0,o.cn)("text-[10px] font-bold px-2 py-0.5 rounded-full border","AVOID"===t.type?"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800":"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800"),children:t.type}),"FOLLOWED"===a&&(0,r.jsx)(i.Z,{size:14,className:"text-green-500"})]}),(0,r.jsx)("h3",{className:(0,o.cn)("font-bold",b?"text-lg":"text-xl"),children:t.name}),!b&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:t.description})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1 text-2xl font-black",children:[(0,r.jsx)(n.Z,{size:24,className:(0,o.cn)(t.currentStreak>0&&"BROKEN"!==a?"fill-orange-500 text-orange-500 animate-pulse":"text-gray-300")}),(0,r.jsx)("span",{children:t.currentStreak})]}),(0,r.jsx)("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider",children:"Current Streak"})]})]}),!b&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6 text-xs text-gray-400 bg-gray-50 dark:bg-white/5 p-2 rounded-lg w-fit",children:[(0,r.jsx)(l.Z,{size:14,className:"text-yellow-500"}),(0,r.jsxs)("span",{children:["Best: ",Math.max(t.highestStreak,t.currentStreak)," days"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{"FOLLOWED"!==a&&(0,x.Z)({particleCount:50,spread:60,origin:{y:.7},colors:["#22c55e","#ffffff"]}),u(t.id,"FOLLOWED")},className:(0,o.cn)("flex-1 flex items-center justify-center gap-2 py-2 rounded-xl text-sm font-medium transition-all active:scale-95","FOLLOWED"===a?"bg-green-500 text-white shadow-lg shadow-green-500/20":"bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 hover:border-green-500 hover:text-green-500"),children:[(0,r.jsx)(i.Z,{size:18}),b?"":"Followed"]}),(0,r.jsxs)("button",{onClick:()=>u(t.id,"BROKEN"),className:(0,o.cn)("flex-1 flex items-center justify-center gap-2 py-2 rounded-xl text-sm font-medium transition-all active:scale-95","BROKEN"===a?"bg-red-500 text-white shadow-lg shadow-red-500/20":"bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800 hover:border-red-500 hover:text-red-500"),children:[(0,r.jsx)(d.Z,{size:18}),b?"":"Broken"]}),(0,r.jsx)("button",{onClick:()=>u(t.id,"SKIP"),className:(0,o.cn)("flex-none w-10 flex items-center justify-center rounded-xl transition-all active:scale-95","SKIP"===a?"bg-gray-500 text-white":"bg-gray-100 dark:bg-zinc-900 text-gray-400 hover:bg-gray-200"),title:"Skip (Day Off)",children:(0,r.jsx)(c.Z,{size:18})})]})]})}},60345:function(e,t,a){"use strict";a.d(t,{cn:function(){return cn}});var r=a(57042),s=a(74769);function cn(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[777,928,769,855,971,472,744],function(){return e(e.s=58457)}),_N_E=e.O()}]);